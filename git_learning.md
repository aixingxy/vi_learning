vim编辑器

# 02 打开和新建文件
在终端中输入`vi`**在后面跟上文件名**即可
```bash
$ vi 文件名
```

1. 如果文件已经存在，会直接打开该文件
2. 如果文件不存在，会新建一个文件

## 2.1 打开文件并且定位行
在日常的工作中，有可能会遇到打开一个文件，并定位到指定行的情况

例如：在开发时，知道某一行代码有错误，可以快速定位出错代码的位置

```bash
$ vi 文件名 + 行数
```
如果只带上`+`而不指定行号，会直接定位到文件末尾行起始非零位置

[如何显示行号](https://jingyan.baidu.com/article/908080220bedeafd91c80fee.html)

## 2.2 删除交换文件
如果使用`vi`异常退出，在磁盘上可能会出现有**交换文件**

下次再使用`vi`编辑改文件时，会看到报错信息，按下字母`d`删除交换文件即可
```text

E325: ATTENTION
Found a swap file by the name ".test.txt.swp"
          owned by: xxy   dated: Thu Jun 28 10:25:41 2018
         file name: ~xxy/PycharmProjects/vi_learning/test.txt
          modified: YES
         user name: xxy   host name: xingsy.local
        process ID: 1619
While opening file "test.txt"

(1) Another program may be editing the same file.  If this is the case,
    be careful not to end up with two different instances of the same
    file when making changes.  Quit, or continue with caution.
(2) An edit session for this file crashed.
    If this is the case, use ":recover" or "vim -r test.txt"
    to recover the changes (see ":help recovery").
    If you did this already, delete the swap file ".test.txt.swp"
    to avoid this message.

Swap file ".test.txt.swp" already exists!
[O]pen Read-Only, (E)dit anyway, (R)ecover, (D)elete it, (Q)uit, (A)bort:
```

## 2.3 移动光标

| 命令 | 功能 |
|:-:|:-:|
| h | 向左 |
| j | 向下 |
| k | 向上 |
| l | 向右 |


## 2.3 行内移动

| 命令 | 功能 |
|-|-|
| w | 向后移动一个单词 |
| b | 向前移动一个单词 |
| 0 | 行首 |
| ^ | 行首，第一个不是空白字符的位置 |
| $ | 行尾 |

## 2.4 行数移动
| 命令 | 功能 |
|-|-|
| gg | 文件顶部 |
| G | 文件尾部 |
| 数字gg | 移动到 数字 对应行数 |
| 数字G | 移动到 数字 对应行数 |
| :数字 | 移动到 数字 对应行数 |

## 2.5 屏幕移动
| 命令 | 功能 |
|-|-|
| ctrl+b | 向上翻页 |
| ctrl+f | 向下翻页 |
| H | 屏幕顶部 |
| M | 屏幕中间 |
| L | 屏幕底部 |

## 2.6 段落移动
`vi`中使用 空行 来区分段落

在程序开发时，通常**一段功能相关的代码会写在一起**之间没有空行
| 命令 | 功能 |
|-|-|
| { | 上一段 |
| } | 下一段 |

## 2.7 括号切换
| 命令 | 功能 |
|-|-|
| % | 括号匹配及切换 |

## 2.8 标记
在开发时，某一段代码可能**需要稍后处理**，例如：编辑查看

此时先使用`m`增加一个标记，这样可以**在需要时快速地跳转回来**或者**执行其他编辑操作**

**标记名称**可以是a~z或者A~Z之间的任意**一个**字母

添加了标记的行如果被删除，标记同时被删除

如果 在其他行添加了相同名称的标记，之间的标记也会被覆盖掉
| 命令 | 功能 |
|-|-|
| mx | 添加标记x，x是a~z或者A~Z之间的任意一个字母 |
| 'x | 直接定位到标记x所在位置 |

## 2.9 选中文本
在`vi`中要选择文本，需要先使用visual命令切换到**可视模式**

按`esc`可以放弃选中，返回到**命令模式**
| 命令 | 功能 |
|-|-|
| v | 从光标位置开始按照正常模式选择文本 |
| V | 选中光标经过的完整行 |
| ctrl+v | 垂直方向选中文本  |

可视模式下，可以和移动命令连用，例如使用ggVG能够选中所有内容

## 3.0 撤销和恢复撤销
| 命令 | 功能 |
|-|-|
| u | 撤销上次命令 |
| ctrl+r | 恢复撤销命令 |

## 3.1 删除文本
| 命令 | 功能 |
|-|-|
| x | 删除光标所在字符，或者选中文字 |
| d(移动命令) | 删除移动命令对应的内容 |
| dd | 删除光标所在行，可以ndd复制多行 |
| D  | 删除至行尾 |

提示：如果使用**可视模式**已经选中了一段文字，那么无论使用`d`还是`x`，都可以删除选中文本

删除命令可以和**移动命令**连用，以下是常见的组合：
```text
dw # 从光标位置删除到单词末尾
d0 # 从光标位置删除到一行的起始位置
d} # 从光标位置删除到段落结尾
ndd # 从光标位置向下连续删除n行
d代码行G # 从光标所在行 删除到 指定代码行 之间的所有代码
d'a # 从光标所在行 删除到 标记a 之间的所有代码
```

## 3.2 复制、粘贴
`vi`中提供一个被复制文本的缓冲区
**复制**命令将选中文字保存在缓冲区
**删除**命令删除的文字会被保存在缓冲区
在需要的位置，使用粘贴命令可以将缓冲区的文字插入到光标所在行的下一行
| 命令 | 功能 |
|-|-|
| y(移动命令) | 复制 |
| yy | 复制一行，可以nyy复制多行 |
| p  | 粘贴 |

## 3.3 替换
| 命令 | 功能 |
|-|-|
| r | 替换当前字符 |
| R | 替换当前光标后的字符 |

## 3.4 缩排和重复执行
| 命令 | 功能 |
|-|-|
| >> | 向右增加缩进 |
| << | 向左增加缩进 |
| .  | 重复上次命令 |

## 3.5 查找命令
| 命令 | 功能 |
|-|-|
| /str | 查找str |

查找到内容之后，使用Next查找下一个出现的位置

`n`：查找下一个
`N`：查找上一个

## 3.6 单词快速匹配
| 命令 | 功能 |
|-|-|
| * | 向后查找当前光标所在的单词 |
| # | 向前查找当前光标所在的单词 |

## 3.7 查找并替换
在`vi`中查找和替换命令中需要在**末行模式**下执行

1) 全局替换

一次性替换文件中的所有出现的旧文件
```text
:%s/旧文件/新文件/g
```
2) 可视区域替换
先选中要替换文字的范围
```text
:s/旧文件/新文件/g
```

3） 确认替换
如果在末尾的`g`改成`gc`在替换的时候，会有提示！
```text
`y`:`yes`替换
`n`:`no`不替换
`a`:`all`替换所有
`q`:`quit`退出替换
`l`:'last'最后一个，并把光标移动到行首
`^E`:向下滚屏
`^Y`:向上滚屏
```

## 3.8 插入命令
| 命令 | 功能 |
|-|-|
| i | 在当前字符前插入文本 |
| I | 在行首插入文本 |
| a | 在当前字符后添加文本 |
| A | 在行末添加文本 |
| o | 在当前行后面添加一空行 |
| O | 在当前行前面添加一空行 |

## 4.0 分屏命令
| 命令 | 功能 |
|-|-|
| :sp[文件名] | 横向增加分屏 |
| :vsp[文件名]| 纵向增加分屏 |

1) 切换分屏窗口
先按ctrl+w

| 命令 | 功能 |
|-|-|
| w | 切换到下一个窗口 |
| r | 互换窗口 |
| c | 关闭当前窗口，但是不能关闭最后一个窗口 |
| q | 退出当前窗口，如果是最后一个窗口，则关闭vi |
| o | 关闭其他窗口 |
